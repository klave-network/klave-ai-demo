import{r as t,j as r,c as S}from"./index-BYcoJFgG.js";import{B as N}from"./button-DaZc31o0.js";import{c as m}from"./createLucideIcon-C-2ZzL6n.js";import"./index-OICOeeHB.js";import"./index-BfnlZZ3t.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],M=m("circle-stop",k);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],E=m("play",T);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],_=m("rotate-cw",I),C=()=>{const[c,g]=t.useState(!1),[i,x]=t.useState(null),[a,b]=t.useState(null),[l,p]=t.useState(null),[v,f]=t.useState(0),n=t.useRef(null),u=t.useRef(null),h=240;t.useEffect(()=>{if(!("MediaRecorder"in window)){console.error("MediaRecorder not supported");return}navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(e=>{console.log("Stream obtained:",e),e.getTracks().forEach(o=>console.log("Track:",o.kind))}).catch(e=>{console.error("Permission denied or error:",e)})},[]),t.useEffect(()=>(i||navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(e=>{x(e),u.current&&(u.current.srcObject=e);const o=new MediaRecorder(e,{mimeType:"video/webm"});b(o);let s=[];o.ondataavailable=d=>{d.data.size>0&&s.push(d.data)},o.onstop=()=>{const d=new Blob(s,{type:"video/webm"});p(d),s=[]}}).catch(e=>{console.error("Error accessing webcam:",e)}),()=>{n.current&&clearInterval(n.current),i&&i.getTracks().forEach(e=>e.stop())}),[i]);const j=()=>{a&&(a.start(),g(!0),f(0),p(null),n.current=window.setInterval(()=>{f(e=>e>=h-1?(R(),h):e+1)},1e3))},R=()=>{a&&(a.stop(),g(!1),n.current&&(clearInterval(n.current),n.current=null))},y=e=>{console.log("handleToggleRecording"),e.preventDefault(),c?R():j()},w=e=>{const o=Math.floor(e/60),s=e%60;return`${o.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`};return r.jsxs("div",{className:"max-w-3xl mx-auto p-4",children:[r.jsx("video",{ref:u,className:"w-full rounded border border-gray-300 mb-4",autoPlay:!0,muted:!0,playsInline:!0}),r.jsx(N,{type:"button",onClick:y,className:S("hover:cursor-pointer w-full rounded font-bold",c?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"),children:c?r.jsxs(r.Fragment,{children:[r.jsx(M,{className:"animate-pulse"})," Stop Recording"]}):l?r.jsxs(r.Fragment,{children:[r.jsx(_,{})," Redo Recording"]}):r.jsxs(r.Fragment,{children:[r.jsx(E,{})," Start Recording"]})}),c&&r.jsxs("p",{className:"mt-2 text-center text-gray-700",children:["Recording... ",w(v)]}),l&&r.jsxs("div",{className:"mt-4",children:[r.jsx("h3",{className:"mb-2 font-semibold",children:"Preview Recording:"}),r.jsx("video",{controls:!0,className:"w-full rounded border border-gray-300",src:URL.createObjectURL(l)})]})]})},O=function(){return r.jsx("div",{children:r.jsx(C,{})})};export{O as component};
