import{i as g,b as f,d as K,h as b,j as e,K as i,L as N,t,s as r,e as v,f as n,C as L}from"./index-BYcoJFgG.js";import{u as R,C as P,b as k,c as I,d as E,a as _}from"./index-Cy7fFoKX.js";import{I as c}from"./input-g_y2zunB.js";import{L as d}from"./label-CfgyWhQi.js";import{B as l}from"./button-DaZc31o0.js";import"./index-qpBqXqUl.js";import"./index-OICOeeHB.js";import"./index-BfnlZZ3t.js";const Y=function(){const{keyname:o}=g.useParams(),m=f(),u=K(),[h]=R(b,[]),p=async x=>{x.preventDefault();const y=decodeURIComponent(o),a=h.find(s=>s.name===y);if(!a){t.error("A user with this key does not exist");return}try{await r.disconnect();const j=await(await r.use(a,i).then(v.importKey)).getRawPublicKey(),w=await n.hash(j);window.currentDevicePublicKeyHash=n.toBase64(w,!0);const C=t.loading("Connecting...");await r.connect(),t.success(`Connected with ${a.name}.`,{id:C}),localStorage.setItem(L,a.name),m.invalidate(),u({to:"/",search:!0})}catch(s){console.error(s),t.error(`Failed to connect with ${a.name}.`)}};return e.jsx("div",{className:"flex flex-col gap-6",children:e.jsxs(P,{children:[e.jsxs(k,{className:"text-center",children:[e.jsx(I,{className:"text-xl",children:"Welcome back"}),e.jsx(E,{children:"Login with your Secretarium key"})]}),e.jsx(_,{children:e.jsx("form",{onSubmit:p,children:e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx(d,{htmlFor:"email",children:"Key Name"}),e.jsx(c,{id:"email",type:"email",placeholder:"m@example.com",defaultValue:decodeURIComponent(o),disabled:!0,required:!0})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(d,{htmlFor:"password",children:"Password"}),e.jsx(c,{id:"password",type:"password",defaultValue:i,disabled:!0,required:!0})]}),e.jsx(l,{type:"submit",className:"w-full hover:cursor-pointer",children:"Login"}),e.jsx(l,{className:"w-full hover:cursor-pointer",variant:"secondary",asChild:!0,children:e.jsx(N,{to:"/login",search:!0,children:"Go back"})})]})})})]})})};export{Y as component};
