import{R as E,j as N,r as d}from"./index-BYcoJFgG.js";import{c as k,d as A}from"./index-DL_SWt5J.js";import{u as M,c as L}from"./index-OICOeeHB.js";import{P as K}from"./index-qpBqXqUl.js";function Z(e){const t=e+"CollectionProvider",[o,c]=k(t),[b,S]=o(t,{collectionRef:{current:null},itemMap:new Map}),F=n=>{const{scope:l,children:r}=n,a=E.useRef(null),u=E.useRef(new Map).current;return N.jsx(b,{scope:l,itemMap:u,collectionRef:a,children:r})};F.displayName=t;const s=e+"CollectionSlot",R=L(s),v=E.forwardRef((n,l)=>{const{scope:r,children:a}=n,u=S(s,r),i=M(l,u.collectionRef);return N.jsx(R,{ref:i,children:a})});v.displayName=s;const p=e+"CollectionItemSlot",C="data-radix-collection-item",y=L(p),f=E.forwardRef((n,l)=>{const{scope:r,children:a,...u}=n,i=E.useRef(null),T=M(l,i),I=S(p,r);return E.useEffect(()=>(I.itemMap.set(i,{ref:i,...u}),()=>void I.itemMap.delete(i))),N.jsx(y,{[C]:"",ref:T,children:a})});f.displayName=p;function h(n){const l=S(e+"CollectionConsumer",n);return E.useCallback(()=>{const a=l.collectionRef.current;if(!a)return[];const u=Array.from(a.querySelectorAll(`[${C}]`));return Array.from(l.itemMap.values()).sort((I,D)=>u.indexOf(I.ref.current)-u.indexOf(D.ref.current))},[l.collectionRef,l.itemMap])}return[{Provider:F,Slot:v,ItemSlot:f},h,c]}var j=d.createContext(void 0);function ee(e){const t=d.useContext(j);return e||t||"ltr"}var O="focusScope.autoFocusOnMount",x="focusScope.autoFocusOnUnmount",P={bubbles:!1,cancelable:!0},H="FocusScope",V=d.forwardRef((e,t)=>{const{loop:o=!1,trapped:c=!1,onMountAutoFocus:b,onUnmountAutoFocus:S,...F}=e,[s,R]=d.useState(null),v=A(b),p=A(S),C=d.useRef(null),y=M(t,n=>R(n)),f=d.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;d.useEffect(()=>{if(c){let n=function(u){if(f.paused||!s)return;const i=u.target;s.contains(i)?C.current=i:m(C.current,{select:!0})},l=function(u){if(f.paused||!s)return;const i=u.relatedTarget;i!==null&&(s.contains(i)||m(C.current,{select:!0}))},r=function(u){if(document.activeElement===document.body)for(const T of u)T.removedNodes.length>0&&m(s)};document.addEventListener("focusin",n),document.addEventListener("focusout",l);const a=new MutationObserver(r);return s&&a.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",n),document.removeEventListener("focusout",l),a.disconnect()}}},[c,s,f.paused]),d.useEffect(()=>{if(s){g.add(f);const n=document.activeElement;if(!s.contains(n)){const r=new CustomEvent(O,P);s.addEventListener(O,v),s.dispatchEvent(r),r.defaultPrevented||(W(G(U(s)),{select:!0}),document.activeElement===n&&m(s))}return()=>{s.removeEventListener(O,v),setTimeout(()=>{const r=new CustomEvent(x,P);s.addEventListener(x,p),s.dispatchEvent(r),r.defaultPrevented||m(n??document.body,{select:!0}),s.removeEventListener(x,p),g.remove(f)},0)}}},[s,v,p,f]);const h=d.useCallback(n=>{if(!o&&!c||f.paused)return;const l=n.key==="Tab"&&!n.altKey&&!n.ctrlKey&&!n.metaKey,r=document.activeElement;if(l&&r){const a=n.currentTarget,[u,i]=q(a);u&&i?!n.shiftKey&&r===i?(n.preventDefault(),o&&m(u,{select:!0})):n.shiftKey&&r===u&&(n.preventDefault(),o&&m(i,{select:!0})):r===a&&n.preventDefault()}},[o,c,f.paused]);return N.jsx(K.div,{tabIndex:-1,...F,ref:y,onKeyDown:h})});V.displayName=H;function W(e,{select:t=!1}={}){const o=document.activeElement;for(const c of e)if(m(c,{select:t}),document.activeElement!==o)return}function q(e){const t=U(e),o=_(t,e),c=_(t.reverse(),e);return[o,c]}function U(e){const t=[],o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:c=>{const b=c.tagName==="INPUT"&&c.type==="hidden";return c.disabled||c.hidden||b?NodeFilter.FILTER_SKIP:c.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)t.push(o.currentNode);return t}function _(e,t){for(const o of e)if(!$(o,{upTo:t}))return o}function $(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function z(e){return e instanceof HTMLInputElement&&"select"in e}function m(e,{select:t=!1}={}){if(e&&e.focus){const o=document.activeElement;e.focus({preventScroll:!0}),e!==o&&z(e)&&t&&e.select()}}var g=B();function B(){let e=[];return{add(t){const o=e[0];t!==o&&(o==null||o.pause()),e=w(e,t),e.unshift(t)},remove(t){var o;e=w(e,t),(o=e[0])==null||o.resume()}}}function w(e,t){const o=[...e],c=o.indexOf(t);return c!==-1&&o.splice(c,1),o}function G(e){return e.filter(t=>t.tagName!=="A")}export{V as F,Z as c,ee as u};
