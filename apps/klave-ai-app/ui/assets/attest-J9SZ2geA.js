import{B as C,f as n,j as e,D as k}from"./index-BYcoJFgG.js";import{L as r}from"./label-CfgyWhQi.js";import{S as j}from"./square-arrow-out-up-right-dxHGDBvv.js";import"./index-qpBqXqUl.js";import"./index-OICOeeHB.js";import"./createLucideIcon-C-2ZzL6n.js";const D=function(){var c,d,l,p,m,h,x,u,w,b;const{currentTime:y,challenge:v,quote:s,version:N,verification:i}=C.useLoaderData(),{wasm_version:a,core_version:o}=N,f=`${o.major}.${o.minor}.${o.patch}`,g=`${a.major}.${a.minor}.${a.patch}`,_=new Blob([new Uint8Array(s.quote_binary)],{type:"application/octet-stream"}),A=n.toBase64(new Uint8Array(((l=(d=(c=s.quote)==null?void 0:c.report_body)==null?void 0:d.mr_enclave)==null?void 0:l.m)??[])),S=n.toBase64(new Uint8Array(((h=(m=(p=s.quote)==null?void 0:p.report_body)==null?void 0:m.mr_signer)==null?void 0:h.m)??[])),R=n.toBase64(new Uint8Array(((u=(x=s.quote)==null?void 0:x.report_body)==null?void 0:u.report_data)??[]));return e.jsxs("div",{className:"pt-4 space-y-4 w-1/2",children:[e.jsx("h3",{className:"text-xl pb-2",children:"Intel SGX Attestation"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Enclave Verification Outcome"}),e.jsx("pre",{className:"p-2 shadow-xs overflow-auto whitespace-pre-wrap break-words border border-border rounded text-gray-400",children:i.quote_verification_result_description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Runtime"}),e.jsx("span",{className:"font-bold",children:"Secretarium Core :"})," ",e.jsxs("span",{className:"text-gray-400",children:["v",f," (",o.build_number,")"]}),e.jsx("br",{}),e.jsx("span",{className:"font-bold",children:"Secretarium WASM :"})," ",e.jsxs("span",{className:"text-gray-400",children:["v",g," (",a.build_number,")"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"MRENCLAVE"}),e.jsx("pre",{className:"p-2 shadow-xs overflow-auto whitespace-pre-wrap break-words border border-border rounded text-gray-400",children:A})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"MRSIGNER"}),e.jsx("pre",{className:"p-2 shadow-xs overflow-auto whitespace-pre-wrap break-words border border-border rounded text-gray-400",children:S})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Contract Integrity Digest"}),e.jsx("pre",{className:"p-2 shadow-xs overflow-auto whitespace-pre-wrap break-words border border-border rounded text-gray-400",children:R})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Challenge"}),e.jsx("pre",{className:"p-2 shadow-xs overflow-auto whitespace-pre-wrap break-words border border-border rounded text-gray-400",children:JSON.stringify(v)??""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Quote Information"}),e.jsxs("a",{download:`intel_quote_${k}_${y}.bin`,href:URL.createObjectURL(_),className:"text-blue-400 hover:underline flex align-middle items-center",children:["Download Quote .bin"," ",e.jsx(j,{className:"ml-2 size-4"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Applicable Intel Security Advisories"}),e.jsx("pre",{className:"p-2 shadow-xs overflow-auto whitespace-pre-wrap break-words border border-border rounded text-gray-400",children:(b=(w=i.sa_list)==null?void 0:w.split(","))==null?void 0:b.map(t=>e.jsxs("a",{title:t,href:`https://www.intel.com/content/www/us/en/security-center/advisory/${t.toLocaleLowerCase()}.html`,target:"_blank",rel:"noreferrer",className:"text-blue-400 hover:underline flex align-middle items-center",children:[t," ",e.jsx(j,{className:"ml-2 size-4"})]},t))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Relying Party"}),e.jsx("pre",{className:"p-2 shadow-xs overflow-auto whitespace-pre-wrap break-words border border-border rounded text-gray-400",children:"Secretarium DCAP"})]})]})};export{D as component};
